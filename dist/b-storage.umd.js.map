{"version":3,"file":"b-storage.umd.js","sources":["../src/helps.ts","../src/Store.ts","../src/index.ts"],"sourcesContent":["// 字符化\nexport function serialize(val: any) {\n  return JSON.stringify(val)\n}\n\n// 反字符化\nexport function deserialize(val: string) {\n  try {\n    return JSON.parse(val)\n  } catch (e) {\n    return val || undefined\n  }\n}\n\n// 混合对象\nexport function extend <T,U>(to:T,from:U): T & U{\n  for (const key in from) {\n    ;(to as T & U)[key] = from[key] as any\n  }\n  return to as T & U\n}\n","import { StorageType, AllRes, StoreConfig } from './types'\nimport { serialize, deserialize } from './helps'\nclass Store {\n  storage: any\n\n  constructor(type:StorageType) {\n    this.storage = window[type]\n  }\n  do(config: StoreConfig):any {\n    // this[config.method](config.key,config.value)\n    switch (config.method) {\n      case 'get':\n          this.get(config.key)\n          break\n      case 'set':\n          this.set(config.key,config.value)\n          break\n      case \"clear\":\n          this.clear()\n           break\n      case \"getAll\":\n           this.getAll()\n           break\n      case \"has\":\n           this.has(config.key)\n           break\n      case \"remove\":\n           this.has(config.key)\n           break\n      default:\n           this.get(config.key)\n\n    }\n  }\n  // 设置storage\n  set(key:string|undefined,value?:any): any {\n    if (!key) return null\n    if (value === undefined) {\n      this.remove(key)\n    }\n    this.storage.setItem(key, serialize(value))\n    return value\n  }\n  // 获取storage\n  get(key:string|undefined): any {\n    if (!key) return undefined\n    let val = deserialize(this.storage.getItem(key))\n    return val === undefined || val === null ? undefined : val\n  }\n\n  // 是否存在这个key\n  has(key:string|undefined): boolean {\n    return this.get(key) !== undefined\n  }\n\n  // 移除这个key\n  remove(key:string|undefined): void {\n    this.storage.removeItem(key)\n  }\n  // 清除storage\n  clear(): void {\n    this.storage.clear()\n  }\n  // 获取所有的storage\n  getAll(): object {\n    let ret: AllRes\n    ret = {}\n    this.forEach((key: string, val: any) => {\n      ret[key] = val\n    })\n    return ret\n  }\n  // 遍历\n  forEach(callback: any) {\n    for (let i = 0; i < this.storage.length; i++) {\n      let key = this.storage.key(i)\n      callback(key, this.get(key))\n    }\n  }\n}\n\nexport default Store\n","import {StoreInstance,StorageType } from './types'\nimport {extend} from \"./helps\";\nimport Store from './Store'\n\nfunction createInstance(type:StorageType = 'localStorage'):StoreInstance {\n  const context = new Store(type)\n  const instance  = Store.prototype.do.bind(context)\n  extend(instance,context)\n  return instance as StoreInstance\n}\n\nconst store = createInstance()\nconst session = createInstance('sessionStorage')\n\nstore.session = session\n\nexport default store\n\n"],"names":[],"mappings":"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"}